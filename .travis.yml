language: cpp
compiler:
  - gcc
# git submodules workaround
git:
  submodules: false
# use sed to replace SSH URL with the public URL, then init submodules 
before_install:
  - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
  - git submodule update --init --recursive
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo apt-get update -qq
  - sudo apt-get install -y libpcap-dev linux-headers-3.13.0-36-generic cmake
  - if [ "$CXX" = "clang++" ]; then sudo apt-get install -qq libstdc++-4.8-dev; fi
  - if [ "$CXX" = "g++" ]; then sudo apt-get install -qq g++-4.8; fi
  - if [ "$CXX" = "g++" ]; then export CXX="g++-4.8" CC="gcc-4.8"; fi
env: BUILD_KERNEL=3.13.0-36-generic
install:
script: ./travis.sh

env:
  global:
   # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
   #   via the "travis encrypt" command using the project repo's public key
   - secure: "XBo95Nca+McyUs5xJfsLD6xiYfP4cVsEkKvyXfgHAd42+k26132WMl/lzdfDYcFIFMqjwUXRqfPruAMP8MSk3yj/71QoFcPrYqJZ+++YMOTJwy043t8WEXBI5Ue+A0kLNX5ohDiK6lMLffRGYKtDB2OTjnFqzbTeQVAd7f0SiYc="

addons:
  coverity_scan:
    project:
      name: "andrew-elder/avdecc-lib"
      description: "Build submitted via Travis CI"
    notification_email: aelder@audioscience.com
    build_command_prepend: ""
    build_command: "./travis.sh"
    branch_pattern: coverity_scan
